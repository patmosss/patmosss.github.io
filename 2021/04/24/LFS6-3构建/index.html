<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>LFS6.3构建 · Patmos</title><meta name="description" content="注：
官方文档 ：官方文档有步骤的详细解释，我这里就不在做介绍。简单的叙述构建过程。所安装的 lfs-livecd 在 /usr/share/LFS-BOOK-6.3-HTML 。
镜像 
我这里使用的镜像是 lfslivecd-x86-6.3-r2130.iso 
安装包位置：/lfs-sourc"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Patmos</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a target="_blank" rel="noopener" href="https://www.caicai.me"> CaiCai </a><span>&</span><a target="_blank" rel="noopener" href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">Home</a></li><li><a href="/about">Sobre</a></li><li><a href="/archives">Arquivo</a></li><li><a href="/links">Links</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>LFS6.3构建</a></h3></div><div class="post-content"><blockquote>
<p><strong>注：</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.linuxfromscratch.org/lfs/download.html">官方文档</a> ：官方文档有步骤的详细解释，我这里就不在做介绍。简单的叙述构建过程。所安装的 <code>lfs-livecd</code> 在 <code>/usr/share/LFS-BOOK-6.3-HTML</code> 。</p>
<p><a target="_blank" rel="noopener" href="http://ftp.osuosl.org/pub/lfs-livecd/">镜像</a> </p>
<p>我这里使用的镜像是 <a target="_blank" rel="noopener" href="http://ftp.osuosl.org/pub/lfs-livecd/lfslivecd-x86-6.3-r2130.iso"><code>lfslivecd-x86-6.3-r2130.iso</code></a> </p>
<p>安装包位置：<code>/lfs-sources</code> </p>
<p>首先你得有耐心来构建完整的 <code>Linux</code> 操作系统，其次是构建过程需要花费大量时间。</p>
<p>客户端操作系统：<code>Linux</code> → <code>其他Linux 2.6.x 内核</code> </p>
<p><code>I/O</code> 控制器类型：<code>LSI Logic</code> </p>
<p>选择磁盘类型：<code>IDE</code> </p>
<p>其他的都默认即可。</p>
</blockquote>
<p><strong>构建前提：</strong></p>
<blockquote>
<ul>
<li><p>创建密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd root</span><br></pre></td></tr></table></figure></li>
<li><p>使用 <code>SSH</code> 连接，开启 <code>sshd</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.d/init.d/sshd start</span><br></pre></td></tr></table></figure></li>
<li><p>设置网络：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net-stup</span><br></pre></td></tr></table></figure></li>
<li><p>磁盘分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 我分了两个 </span><br><span class="line">  hda1：swap：1G</span><br><span class="line">  hda2：ext3：7G</span><br><span class="line">  </span><br><span class="line">mke2fs -jv /dev/hda2   </span><br><span class="line">mkswap /dev/hda1</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<h1 id="一、前提须知"><a href="#一、前提须知" class="headerlink" title="一、前提须知"></a>一、前提须知</h1><blockquote>
<p><font color=red><strong>强烈建议看着官网文档或者官方中文文档进行操作</strong></font></p>
</blockquote>
<h2 id="1）基础构建"><a href="#1）基础构建" class="headerlink" title="1）基础构建"></a>1）基础构建</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">export LFS=/mnt/lfs # 注意，一旦shell断开就消失了</span><br><span class="line">mkdir -pv $LFS</span><br><span class="line">mount -v -t ext3 /dev/hda2 $LFS</span><br><span class="line">mkdir -v $LFS/sources</span><br><span class="line">chmod -v a+wt $LFS/sources</span><br><span class="line">mkdir -v $LFS/tools</span><br><span class="line">ln -sv $LFS/tools /</span><br><span class="line"></span><br><span class="line">groupadd lfs</span><br><span class="line">useradd -s /bin/bash -g lfs -m -k /dev/null lfs</span><br><span class="line">passwd lfs</span><br><span class="line"></span><br><span class="line">chown -v lfs $LFS/tools</span><br><span class="line">chown -v lfs $LFS/sources</span><br><span class="line"></span><br><span class="line">su - lfs</span><br><span class="line">cat &gt; ~/.bash_profile &lt;&lt; &quot;EOF&quot;</span><br><span class="line">exec env -i HOME=$HOME TERM=$TERM PS1=&#x27;\u:\w\$ &#x27; /bin/bash</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; ~/.bashrc &lt;&lt; &quot;EOF&quot;</span><br><span class="line">set +h</span><br><span class="line">umask 022</span><br><span class="line">LFS=/mnt/lfs</span><br><span class="line">LC_ALL=POSIX</span><br><span class="line">PATH=/tools/bin:/bin:/usr/bin</span><br><span class="line">export LFS LC_ALL PATH</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">source ~/.bash_profile</span><br><span class="line">cd $LFS/sources</span><br></pre></td></tr></table></figure>

<h1 id="二、构建-LFS-1"><a href="#二、构建-LFS-1" class="headerlink" title="二、构建 LFS-1"></a>二、构建 <code>LFS-1</code></h1><h2 id="1）Binutils-2-17-Pass-1"><a href="#1）Binutils-2-17-Pass-1" class="headerlink" title="1）Binutils-2.17 - Pass 1"></a>1）<code>Binutils-2.17 - Pass 1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/binutils-2.17.tar.bz2</span><br><span class="line">cd binutils-2.17</span><br><span class="line">mkdir -v ../binutils-build</span><br><span class="line">cd ../binutils-build</span><br><span class="line">CC=&quot;gcc -B/usr/bin/&quot; ../binutils-2.17/configure \</span><br><span class="line">--prefix=/tools --disable-nls --disable-werror</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make -C ld clean</span><br><span class="line">make -C ld LIB_PATH=/tools/lib</span><br><span class="line">cp -v ld/ld-new /tools/bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf binutils-build</span><br><span class="line">rm -rf binutils-2.17</span><br></pre></td></tr></table></figure>

<h2 id="2）GCC-4-1-2-Pass-1"><a href="#2）GCC-4-1-2-Pass-1" class="headerlink" title="2）GCC-4.1.2 - Pass 1"></a>2）<code>GCC-4.1.2 - Pass 1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/gcc-4.1.2.tar.bz2</span><br><span class="line">cd gcc-4.1.2</span><br><span class="line">mkdir -v ../gcc-build</span><br><span class="line">cd ../gcc-build</span><br><span class="line">CC=&quot;gcc -B/usr/bin/&quot; ../gcc-4.1.2/configure --prefix=/tools \</span><br><span class="line">--with-local-prefix=/tools --disable-nls --enable-shared \</span><br><span class="line">--enable-languages=c</span><br><span class="line">make bootstrap</span><br><span class="line">make install</span><br><span class="line">ln -vs gcc /tools/bin/cc</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gcc-build</span><br><span class="line">rm -rf gcc-4.1.2</span><br></pre></td></tr></table></figure>

<h2 id="3）Linux-2-6-22-5-API-Headers"><a href="#3）Linux-2-6-22-5-API-Headers" class="headerlink" title="3）Linux-2.6.22.5 API Headers"></a>3）<code>Linux-2.6.22.5 API Headers</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/linux-2.6.22.5.tar.bz2</span><br><span class="line">cd linux-2.6.22.5</span><br><span class="line">make mrproper</span><br><span class="line">make headers_check</span><br><span class="line">make INSTALL_HDR_PATH=dest headers_install</span><br><span class="line">cp -rv dest/include/* /tools/include</span><br><span class="line">cd ..</span><br><span class="line">rm -rf linux-2.6.22.5</span><br></pre></td></tr></table></figure>

<h2 id="4）Glibc-2-5-1"><a href="#4）Glibc-2-5-1" class="headerlink" title="4）Glibc-2.5.1"></a>4）<code>Glibc-2.5.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/glibc-2.5.1.tar.bz2</span><br><span class="line">cd glibc-2.5.1</span><br><span class="line">mkdir -v ../glibc-build</span><br><span class="line">cd ../glibc-build</span><br><span class="line">../glibc-2.5.1/configure --prefix=/tools \</span><br><span class="line">--disable-profile --enable-add-ons \</span><br><span class="line">--enable-kernel=2.6.0 --with-binutils=/tools/bin \</span><br><span class="line">--without-gd --with-headers=/tools/include \</span><br><span class="line">--without-selinux</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">mkdir -v /tools/etc</span><br><span class="line">touch /tools/etc/ld.so.conf</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf glibc-build</span><br><span class="line">rm -rf glibc-2.5.1</span><br></pre></td></tr></table></figure>

<h2 id="5）调整工具链"><a href="#5）调整工具链" class="headerlink" title="5）调整工具链"></a>5）调整工具链</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mv -v /tools/bin/&#123;ld,ld-old&#125;</span><br><span class="line">mv -v /tools/$(gcc -dumpmachine)/bin/&#123;ld,ld-old&#125;</span><br><span class="line">mv -v /tools/bin/&#123;ld-new,ld&#125;</span><br><span class="line">ln -sv /tools/bin/ld /tools/$(gcc -dumpmachine)/bin/ld</span><br><span class="line">gcc -dumpspecs | sed &#x27;s@^/lib/ld-linux.so.2@/tools&amp;@g&#x27; \</span><br><span class="line">&gt; `dirname $(gcc -print-libgcc-file-name)`/specs</span><br><span class="line">GCC_INCLUDEDIR=`dirname $(gcc -print-libgcc-file-name)`/include &amp;&amp;</span><br><span class="line">find $&#123;GCC_INCLUDEDIR&#125;/* -maxdepth 0 -xtype d -exec rm -rvf &#x27;&#123;&#125;&#x27; \; &amp;&amp;</span><br><span class="line">rm -vf `grep -l &quot;DO NOT EDIT THIS FILE&quot; $&#123;GCC_INCLUDEDIR&#125;/*` &amp;&amp;</span><br><span class="line">unset GCC_INCLUDEDIR</span><br><span class="line"></span><br><span class="line">echo &#x27;main()&#123;&#125;&#x27; &gt; dummy.c</span><br><span class="line">cc dummy.c</span><br><span class="line">readelf -l a.out | grep &#x27;: /tools&#x27;</span><br><span class="line"></span><br><span class="line">rm -v dummy.c a.out</span><br></pre></td></tr></table></figure>

<h2 id="6）Tcl-8-4-15"><a href="#6）Tcl-8-4-15" class="headerlink" title="6）Tcl-8.4.15"></a>6）<code>Tcl-8.4.15</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/tcl8.4.15-src.tar.gz</span><br><span class="line">cd tcl8.4.15</span><br><span class="line">cd unix</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make install-private-headers</span><br><span class="line">ln -sv tclsh8.4 /tools/bin/tclsh</span><br><span class="line">cd ..</span><br><span class="line">cd ..</span><br><span class="line">rm -rf tcl8.4.15</span><br></pre></td></tr></table></figure>

<h2 id="7）Expect-5-43-0"><a href="#7）Expect-5-43-0" class="headerlink" title="7）Expect-5.43.0"></a>7）<code>Expect-5.43.0</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/expect-5.43.0.tar.gz</span><br><span class="line">cd expect-5.43</span><br><span class="line">patch -Np1 -i /lfs-sources/expect-5.43.0-spawn-1.patch</span><br><span class="line">cp configure&#123;,.bak&#125;</span><br><span class="line">sed &#x27;s:/usr/local/bin:/bin:&#x27; configure.bak &gt; configure</span><br><span class="line">./configure --prefix=/tools --with-tcl=/tools/lib \</span><br><span class="line">--with-tclinclude=/tools/include --with-x=no</span><br><span class="line">make</span><br><span class="line">make SCRIPTS=&quot;&quot; install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf expect-5.43</span><br></pre></td></tr></table></figure>

<h2 id="8）DejaGNU-1-4-4"><a href="#8）DejaGNU-1-4-4" class="headerlink" title="8）DejaGNU-1.4.4"></a>8）<code>DejaGNU-1.4.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/dejagnu-1.4.4.tar.gz</span><br><span class="line">cd dejagnu-1.4.4</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf dejagnu-1.4.4</span><br></pre></td></tr></table></figure>

<h2 id="9）GCC-4-1-2-Pass-2"><a href="#9）GCC-4-1-2-Pass-2" class="headerlink" title="9）GCC-4.1.2 - Pass 2"></a>9）<code>GCC-4.1.2 - Pass 2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/gcc-4.1.2.tar.bz2</span><br><span class="line">cd gcc-4.1.2</span><br><span class="line">cp -v gcc/Makefile.in&#123;,.orig&#125;</span><br><span class="line">sed &#x27;s@\./fixinc\.sh@-c true@&#x27; gcc/Makefile.in.orig &gt; gcc/Makefile.in</span><br><span class="line">cp -v gcc/Makefile.in&#123;,.tmp&#125;</span><br><span class="line">sed &#x27;s/^XCFLAGS =$/&amp; -fomit-frame-pointer/&#x27; gcc/Makefile.in.tmp \</span><br><span class="line">&gt; gcc/Makefile.in</span><br><span class="line">patch -Np1 -i /lfs-sources/gcc-4.1.2-specs-1.patch</span><br><span class="line">mkdir -v ../gcc-build</span><br><span class="line">cd ../gcc-build</span><br><span class="line">../gcc-4.1.2/configure --prefix=/tools \</span><br><span class="line">--with-local-prefix=/tools --enable-clocale=gnu \</span><br><span class="line">--enable-shared --enable-threads=posix \</span><br><span class="line">--enable-__cxa_atexit --enable-languages=c,c++ \</span><br><span class="line">--disable-libstdcxx-pch</span><br><span class="line">make</span><br><span class="line">make -k check</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gcc-4.1.2</span><br><span class="line">rm -rf gcc-build</span><br><span class="line"></span><br><span class="line">测试:</span><br><span class="line">echo &#x27;main()&#123;&#125;&#x27; &gt; dummy.c</span><br><span class="line">cc dummy.c</span><br><span class="line">readelf -l a.out | grep &#x27;: /tools&#x27;</span><br><span class="line"></span><br><span class="line">rm -v dummy.c a.out</span><br></pre></td></tr></table></figure>

<h2 id="10）Binutils-2-17-Pass-2"><a href="#10）Binutils-2-17-Pass-2" class="headerlink" title="10）Binutils-2.17 - Pass 2"></a>10）<code>Binutils-2.17 - Pass 2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/binutils-2.17.tar.bz2</span><br><span class="line">cd binutils-2.17</span><br><span class="line">mkdir -v ../binutils-build</span><br><span class="line">cd ../binutils-build</span><br><span class="line">../binutils-2.17/configure --prefix=/tools \</span><br><span class="line">--disable-nls --with-lib-path=/tools/lib</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">make -C ld clean</span><br><span class="line">make -C ld LIB_PATH=/usr/lib:/lib</span><br><span class="line">cp -v ld/ld-new /tools/bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf binutils-2.17</span><br><span class="line">rm -rf binutils-build</span><br></pre></td></tr></table></figure>

<h2 id="11）Ncurses-5-6"><a href="#11）Ncurses-5-6" class="headerlink" title="11）Ncurses-5.6"></a>11）<code>Ncurses-5.6</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/ncurses-5.6.tar.gz</span><br><span class="line">cd ncurses-5.6</span><br><span class="line">./configure --prefix=/tools --with-shared \</span><br><span class="line">--without-debug --without-ada --enable-overwrite</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf ncurses-5.6</span><br></pre></td></tr></table></figure>

<h2 id="12）Bash-3-2"><a href="#12）Bash-3-2" class="headerlink" title="12）Bash-3.2"></a>12）<code>Bash-3.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/bash-3.2.tar.gz</span><br><span class="line">cd bash-3.2</span><br><span class="line">patch -Np1 -i /lfs-sources/bash-3.2-fixes-5.patch</span><br><span class="line">./configure --prefix=/tools --without-bash-malloc</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ln -vs bash /tools/bin/sh</span><br><span class="line">cd ..</span><br><span class="line">rm -rf bash-3.2</span><br></pre></td></tr></table></figure>

<h2 id="13）Bzip2-1-0-4"><a href="#13）Bzip2-1-0-4" class="headerlink" title="13）Bzip2-1.0.4"></a>13）<code>Bzip2-1.0.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/bzip2-1.0.4.tar.gz</span><br><span class="line">cd bzip2-1.0.4</span><br><span class="line">make</span><br><span class="line">make PREFIX=/tools install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf bzip2-1.0.4</span><br></pre></td></tr></table></figure>

<h2 id="14）Coreutils-6-9"><a href="#14）Coreutils-6-9" class="headerlink" title="14）Coreutils-6.9"></a>14）<code>Coreutils-6.9</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/coreutils-6.9.tar.bz2</span><br><span class="line">cd coreutils-6.9</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cp -v src/su /tools/bin/su-tools</span><br><span class="line">cd ..</span><br><span class="line">rm -rf coreutils-6.9</span><br></pre></td></tr></table></figure>

<h2 id="15）Diffutils-2-8-1"><a href="#15）Diffutils-2-8-1" class="headerlink" title="15）Diffutils-2.8.1"></a>15）<code>Diffutils-2.8.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/diffutils-2.8.1.tar.gz</span><br><span class="line">cd diffutils-2.8.1</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf diffutils-2.8.1</span><br></pre></td></tr></table></figure>

<h2 id="16）Findutils-4-2-31"><a href="#16）Findutils-4-2-31" class="headerlink" title="16）Findutils-4.2.31"></a>16）<code>Findutils-4.2.31</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/findutils-4.2.31.tar.gz</span><br><span class="line">cd findutils-4.2.31</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf findutils-4.2.31</span><br></pre></td></tr></table></figure>

<h2 id="17）Gawk-3-1-5"><a href="#17）Gawk-3-1-5" class="headerlink" title="17）Gawk-3.1.5"></a>17）<code>Gawk-3.1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/gawk-3.1.5.tar.bz2</span><br><span class="line">cd gawk-3.1.5</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">cat &gt;&gt; config.h &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#define HAVE_LANGINFO_CODESET 1</span><br><span class="line">#define HAVE_LC_MESSAGES 1</span><br><span class="line">EOF</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gawk-3.1.5</span><br></pre></td></tr></table></figure>

<h2 id="18）Gettext-0-16-1"><a href="#18）Gettext-0-16-1" class="headerlink" title="18）Gettext-0.16.1"></a>18）<code>Gettext-0.16.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/gettext-0.16.1.tar.gz</span><br><span class="line">cd gettext-0.16.1</span><br><span class="line">cd gettext-tools</span><br><span class="line">./configure --prefix=/tools --disable-shared</span><br><span class="line">make -C gnulib-lib</span><br><span class="line">make -C src msgfmt</span><br><span class="line">cp -v src/msgfmt /tools/bin</span><br><span class="line">cd ..</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gettext-0.16.1</span><br></pre></td></tr></table></figure>

<h2 id="19）Grep-2-5-1a"><a href="#19）Grep-2-5-1a" class="headerlink" title="19）Grep-2.5.1a"></a>19）<code>Grep-2.5.1a</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/grep-2.5.1a.tar.bz2</span><br><span class="line">cd grep-2.5.1a</span><br><span class="line">./configure --prefix=/tools \</span><br><span class="line">--disable-perl-regexp</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf grep-2.5.1a</span><br></pre></td></tr></table></figure>

<h2 id="20）Gzip-1-3-12"><a href="#20）Gzip-1-3-12" class="headerlink" title="20）Gzip-1.3.12"></a>20）<code>Gzip-1.3.12</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/gzip-1.3.12.tar.gz</span><br><span class="line">cd gzip-1.3.12</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gzip-1.3.12</span><br></pre></td></tr></table></figure>

<h2 id="21）Make-3-81"><a href="#21）Make-3-81" class="headerlink" title="21）Make-3.81"></a>21）<code>Make-3.81</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/make-3.81.tar.bz2</span><br><span class="line">cd make-3.81</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf make-3.81</span><br></pre></td></tr></table></figure>

<h2 id="22）Patch-2-5-4"><a href="#22）Patch-2-5-4" class="headerlink" title="22）Patch-2.5.4"></a>22）<code>Patch-2.5.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/patch-2.5.4.tar.gz</span><br><span class="line">cd patch-2.5.4</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf patch-2.5.4</span><br></pre></td></tr></table></figure>

<h2 id="23）Perl-5-8-8"><a href="#23）Perl-5-8-8" class="headerlink" title="23）Perl-5.8.8"></a>23）<code>Perl-5.8.8</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/perl-5.8.8.tar.bz2</span><br><span class="line">cd perl-5.8.8</span><br><span class="line">patch -Np1 -i /lfs-sources/perl-5.8.8-libc-2.patch</span><br><span class="line">./configure.gnu --prefix=/tools -Dstatic_ext=&#x27;Data/Dumper Fcntl IO POSIX&#x27;</span><br><span class="line">make perl utilities</span><br><span class="line">cp -v perl pod/pod2man /tools/bin</span><br><span class="line">mkdir -pv /tools/lib/perl5/5.8.8</span><br><span class="line">cp -Rv lib/* /tools/lib/perl5/5.8.8</span><br><span class="line">cd ..</span><br><span class="line">rm -rf perl-5.8.8</span><br></pre></td></tr></table></figure>

<h2 id="24）Sed-4-1-5"><a href="#24）Sed-4-1-5" class="headerlink" title="24）Sed-4.1.5"></a>24）<code>Sed-4.1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/sed-4.1.5.tar.gz</span><br><span class="line">cd sed-4.1.5</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf sed-4.1.5</span><br></pre></td></tr></table></figure>

<h2 id="25）Tar-1-18"><a href="#25）Tar-1-18" class="headerlink" title="25）Tar-1.18"></a>25）<code>Tar-1.18</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/tar-1.18.tar.bz2</span><br><span class="line">cd tar-1.18</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf tar-1.18</span><br></pre></td></tr></table></figure>

<h2 id="26）Texinfo-4-9"><a href="#26）Texinfo-4-9" class="headerlink" title="26）Texinfo-4.9"></a>26）<code>Texinfo-4.9</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/texinfo-4.9.tar.bz2</span><br><span class="line">cd texinfo-4.9</span><br><span class="line">./configure --prefix=/tools</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf texinfo-4.9</span><br></pre></td></tr></table></figure>

<h2 id="27）Util-linux-2-12r"><a href="#27）Util-linux-2-12r" class="headerlink" title="27）Util-linux-2.12r"></a>27）<code>Util-linux-2.12r</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf /lfs-sources/util-linux-2.12r.tar.bz2</span><br><span class="line">cd util-linux-2.12r</span><br><span class="line">sed -i &#x27;s@/usr/include@/tools/include@g&#x27; configure</span><br><span class="line">./configure</span><br><span class="line">make -C lib</span><br><span class="line">make -C mount mount umount</span><br><span class="line">make -C text-utils more</span><br><span class="line">cp -v mount/&#123;,u&#125;mount text-utils/more /tools/bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf util-linux-2.12r</span><br></pre></td></tr></table></figure>

<h2 id="28）清理系统"><a href="#28）清理系统" class="headerlink" title="28）清理系统"></a>28）清理系统</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">strip --strip-debug /tools/lib/*</span><br><span class="line">strip --strip-unneeded /tools/&#123;,s&#125;bin/*</span><br><span class="line">rm -rf /tools/&#123;info,man&#125;</span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line"># 改变所有者</span><br><span class="line">chown -R root:root $LFS/tools</span><br><span class="line"></span><br><span class="line">cp -v /lfs-sources/* /mnt/lfs/sources/</span><br></pre></td></tr></table></figure>

<h1 id="三、构建-LFS-2"><a href="#三、构建-LFS-2" class="headerlink" title="三、构建 LFS-2"></a>三、构建 <code>LFS-2</code></h1><h2 id="1）挂载虚拟内核文件系统"><a href="#1）挂载虚拟内核文件系统" class="headerlink" title="1）挂载虚拟内核文件系统"></a>1）挂载虚拟内核文件系统</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir -pv $LFS/&#123;dev,proc,sys&#125;</span><br><span class="line">mknod -m 600 $LFS/dev/console c 5 1</span><br><span class="line">mknod -m 666 $LFS/dev/null c 1 3</span><br><span class="line">mount -v --bind /dev $LFS/dev</span><br><span class="line">mount -vt devpts devpts $LFS/dev/pts</span><br><span class="line">mount -vt tmpfs shm $LFS/dev/shm</span><br><span class="line">mount -vt proc proc $LFS/proc</span><br><span class="line">mount -vt sysfs sysfs $LFS/sys</span><br></pre></td></tr></table></figure>

<h2 id="2）进入-Chroot-环境"><a href="#2）进入-Chroot-环境" class="headerlink" title="2）进入 Chroot 环境"></a>2）进入 Chroot 环境</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chroot &quot;$LFS&quot; /tools/bin/env -i \</span><br><span class="line">HOME=/root TERM=&quot;$TERM&quot; PS1=&#x27;\u:\w\$ &#x27; \</span><br><span class="line">PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin \</span><br><span class="line">/tools/bin/bash --login +h</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3）创建系统目录结构"><a href="#3）创建系统目录结构" class="headerlink" title="3）创建系统目录结构"></a>3）创建系统目录结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mkdir -pv /&#123;bin,boot,etc/opt,home,lib,mnt,opt&#125;</span><br><span class="line">mkdir -pv /&#123;media/&#123;floppy,cdrom&#125;,sbin,srv,var&#125;</span><br><span class="line">install -dv -m 0750 /root</span><br><span class="line">install -dv -m 1777 /tmp /var/tmp</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;&#123;bin,include,lib,sbin,src&#125;</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;share/&#123;doc,info,locale,man&#125;</span><br><span class="line">mkdir -v /usr/&#123;,local/&#125;share/&#123;misc,terminfo,zoneinfo&#125;</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;share/man/man&#123;1..8&#125;</span><br><span class="line">for dir in /usr /usr/local; do</span><br><span class="line">ln -sv share/&#123;man,doc,info&#125; $dir</span><br><span class="line">done</span><br><span class="line">mkdir -v /var/&#123;lock,log,mail,run,spool&#125;</span><br><span class="line">mkdir -pv /var/&#123;opt,cache,lib/&#123;misc,locate&#125;,local&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4）创建必需的文件与符号连接"><a href="#4）创建必需的文件与符号连接" class="headerlink" title="4）创建必需的文件与符号连接"></a>4）创建必需的文件与符号连接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ln -sv /tools/bin/&#123;bash,cat,echo,grep,pwd,stty&#125; /bin</span><br><span class="line">ln -sv /tools/bin/perl /usr/bin</span><br><span class="line">ln -sv /tools/lib/libgcc_s.so&#123;,.1&#125; /usr/lib</span><br><span class="line">ln -sv /tools/lib/libstdc++.so&#123;,.6&#125; /usr/lib</span><br><span class="line">ln -sv bash /bin/sh</span><br><span class="line"></span><br><span class="line">touch /etc/mtab</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/passwd &lt;&lt; &quot;EOF&quot;</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">nobody:x:99:99:Unprivileged User:/dev/null:/bin/false</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/group &lt;&lt; &quot;EOF&quot;</span><br><span class="line">root:x:0:</span><br><span class="line">bin:x:1:</span><br><span class="line">sys:x:2:</span><br><span class="line">kmem:x:3:</span><br><span class="line">tty:x:4:</span><br><span class="line">tape:x:5:</span><br><span class="line">daemon:x:6:</span><br><span class="line">floppy:x:7:</span><br><span class="line">disk:x:8:</span><br><span class="line">lp:x:9:</span><br><span class="line">dialout:x:10:</span><br><span class="line">audio:x:11:</span><br><span class="line">video:x:12:</span><br><span class="line">utmp:x:13:</span><br><span class="line">usb:x:14:</span><br><span class="line">cdrom:x:15:</span><br><span class="line">mail:x:34:</span><br><span class="line">nogroup:x:99:</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">exec /tools/bin/bash --login +h</span><br><span class="line"></span><br><span class="line">touch /var/run/utmp /var/log/&#123;btmp,lastlog,wtmp&#125;</span><br><span class="line">chgrp -v utmp /var/run/utmp /var/log/lastlog</span><br><span class="line">chmod -v 664 /var/run/utmp /var/log/lastlog</span><br></pre></td></tr></table></figure>

<h2 id="5）Linux-2-6-22-5-API-Headers"><a href="#5）Linux-2-6-22-5-API-Headers" class="headerlink" title="5）Linux-2.6.22.5 API Headers"></a>5）<code>Linux-2.6.22.5 API Headers</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /sources/</span><br><span class="line"></span><br><span class="line">tar xvf linux-2.6.22.5.tar.bz2</span><br><span class="line">cd linux-2.6.22.5</span><br><span class="line">sed -i &#x27;/scsi/d&#x27; include/Kbuild</span><br><span class="line">make mrproper</span><br><span class="line">make headers_check</span><br><span class="line">make INSTALL_HDR_PATH=dest headers_install</span><br><span class="line">cp -rv dest/includecrt[1in].*succeeded&#x27; dummy.log</span><br></pre></td></tr></table></figure>

<h2 id="6）Man-pages-2-63"><a href="#6）Man-pages-2-63" class="headerlink" title="6）Man-pages-2.63"></a>6）<code>Man-pages-2.63</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar xf Man-pages-2.63.tar.bz2</span><br><span class="line">cd man-pages-2.63/</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf make-pages-2.63</span><br></pre></td></tr></table></figure>

<h2 id="7）Glibc-2-5-1"><a href="#7）Glibc-2-5-1" class="headerlink" title="7）Glibc-2.5.1"></a>7）<code>Glibc-2.5.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">tar xf glibc-2.5.1.tar.bz2</span><br><span class="line">cd Glibc-2.5.1/</span><br><span class="line">tar -xvf ../glibc-libidn-2.5.1.tar.gz</span><br><span class="line">mv glibc-libidn-2.5.1 libidn</span><br><span class="line">sed -i &#x27;/vi_VN.TCVN/d&#x27; localedata/SUPPORTED</span><br><span class="line">sed -i \</span><br><span class="line">&#x27;s|libs -o|libs -L/usr/lib -Wl,-dynamic-linker=/lib/ld-linux.so.2 -o|&#x27; \</span><br><span class="line">        scripts/test-installation.pl</span><br><span class="line">sed -i &#x27;s|@BASH@|/bin/bash|&#x27; elf/ldd.bash.in</span><br><span class="line">mkdir -v ../glibc-build</span><br><span class="line">cd ../glibc-build</span><br><span class="line">../glibc-2.5.1/configure --prefix=/usr \</span><br><span class="line">    --disable-profile --enable-add-ons \</span><br><span class="line">    --enable-kernel=2.6.0 --libexecdir=/usr/lib/glibc</span><br><span class="line">make</span><br><span class="line">make -k check 2&gt;&amp;1 | tee glibc-check-log</span><br><span class="line">grep Error glibc-check-log</span><br><span class="line">touch /etc/ld.so.conf</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">mkdir -pv /usr/lib/locale</span><br><span class="line">localedef -i de_DE -f ISO-8859-1 de_DE</span><br><span class="line">localedef -i de_DE@euro -f ISO-8859-15 de_DE@euro</span><br><span class="line">localedef -i en_HK -f ISO-8859-1 en_HK</span><br><span class="line">localedef -i en_PH -f ISO-8859-1 en_PH</span><br><span class="line">localedef -i en_US -f ISO-8859-1 en_US</span><br><span class="line">localedef -i en_US -f UTF-8 en_US.UTF-8</span><br><span class="line">localedef -i es_MX -f ISO-8859-1 es_MX</span><br><span class="line">localedef -i fa_IR -f UTF-8 fa_IR</span><br><span class="line">localedef -i fr_FR -f ISO-8859-1 fr_FR</span><br><span class="line">localedef -i fr_FR@euro -f ISO-8859-15 fr_FR@euro</span><br><span class="line">localedef -i fr_FR -f UTF-8 fr_FR.UTF-8</span><br><span class="line">localedef -i it_IT -f ISO-8859-1 it_IT</span><br><span class="line">localedef -i ja_JP -f EUC-JP ja_JP</span><br><span class="line"></span><br><span class="line">make localedata/install-locales</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/nsswitch.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/nsswitch.conf</span><br><span class="line"></span><br><span class="line">passwd: files</span><br><span class="line">group: files</span><br><span class="line">shadow: files</span><br><span class="line"></span><br><span class="line">hosts: files dns</span><br><span class="line">networks: files</span><br><span class="line"></span><br><span class="line">protocols: files</span><br><span class="line">services: files</span><br><span class="line">ethers: files</span><br><span class="line">rpc: files</span><br><span class="line"></span><br><span class="line"># End /etc/nsswitch.conf</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">tzselect</span><br><span class="line">cp -v --remove-destination /usr/share/zoneinfo/Asia/Shanghai \</span><br><span class="line">    /etc/localtime</span><br><span class="line">    </span><br><span class="line">cat &gt; /etc/ld.so.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/ld.so.conf</span><br><span class="line"></span><br><span class="line">/usr/local/lib</span><br><span class="line">/opt/lib</span><br><span class="line"></span><br><span class="line"># End /etc/ld.so.conf</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="8）再次调整工具链"><a href="#8）再次调整工具链" class="headerlink" title="8）再次调整工具链"></a>8）再次调整工具链</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mv -v /tools/bin/&#123;ld,ld-old&#125;</span><br><span class="line">mv -v /tools/$(gcc -dumpmachine)/bin/&#123;ld,ld-old&#125;</span><br><span class="line">mv -v /tools/bin/&#123;ld-new,ld&#125;</span><br><span class="line">ln -sv /tools/bin/ld /tools/$(gcc -dumpmachine)/bin/ld</span><br><span class="line"></span><br><span class="line">gcc -dumpspecs | sed \</span><br><span class="line">    -e &#x27;s@/tools/lib/ld-linux.so.2@/lib/ld-linux.so.2@g&#x27; \</span><br><span class="line">    -e &#x27;/\*startfile_prefix_spec:/&#123;n;s@.*@/usr/lib/ @&#125;&#x27; \</span><br><span class="line">    -e &#x27;/\*cpp:/&#123;n;s@$@ -isystem /usr/include@&#125;&#x27; &gt; \</span><br><span class="line">    `dirname $(gcc --print-libgcc-file-name)`/specs</span><br><span class="line"></span><br><span class="line">echo &#x27;main()&#123;&#125;&#x27; &gt; dummy.c</span><br><span class="line">cc dummy.c -v -Wl,--verbose &amp;&gt; dummy.log</span><br><span class="line">readelf -l a.out | grep &#x27;: /lib&#x27;</span><br><span class="line"></span><br><span class="line">grep -o &#x27;/usr/lib.*/crt[1in].*succeeded&#x27; dummy.log</span><br><span class="line"></span><br><span class="line">grep -B1 &#x27;^ /usr/include&#x27; dummy.log</span><br><span class="line"></span><br><span class="line">grep &#x27;SEARCH.*/usr/lib&#x27; dummy.log |sed &#x27;s|; |\n|g&#x27;</span><br><span class="line"></span><br><span class="line">grep &quot;/lib/libc.so.6 &quot; dummy.log</span><br><span class="line"></span><br><span class="line">grep found dummy.log</span><br><span class="line"></span><br><span class="line">rm -v dummy.c a.out dummy.log</span><br></pre></td></tr></table></figure>

<h2 id="9）Binutils-2-17"><a href="#9）Binutils-2-17" class="headerlink" title="9）Binutils-2.17"></a>9）<code>Binutils-2.17</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">expect -c &quot;spawn ls&quot;</span><br><span class="line"></span><br><span class="line">tar xvf binutils-2.17.tar.bz2</span><br><span class="line">cd binutils-2.17</span><br><span class="line">mkdir -v ../binutils-build</span><br><span class="line">cd ../binutils-build</span><br><span class="line">../binutils-2.17/configure --prefix=/usr \</span><br><span class="line">--enable-shared</span><br><span class="line">make tooldir=/usr</span><br><span class="line">make check</span><br><span class="line">make tooldir=/usr install</span><br><span class="line">cp -v ../binutils-2.17/include/libiberty.h /usr/include</span><br><span class="line">cd ..</span><br><span class="line">rm -rf binutils-2.17</span><br><span class="line">rm -rf binutils-build</span><br></pre></td></tr></table></figure>

<h2 id="10）GCC-4-1-2"><a href="#10）GCC-4-1-2" class="headerlink" title="10）GCC-4.1.2"></a>10）<code>GCC-4.1.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">tar xvf gcc-4.1.2.tar.bz2</span><br><span class="line">cd gcc-4.1.2</span><br><span class="line">sed -i &#x27;s/install_to_$(INSTALL_DEST) //&#x27; libiberty/Makefile.in</span><br><span class="line">sed -i &#x27;s/^XCFLAGS =$/&amp; -fomit-frame-pointer/&#x27; gcc/Makefile.in</span><br><span class="line">sed -i &#x27;s@\./fixinc\.sh@-c true@&#x27; gcc/Makefile.in</span><br><span class="line">sed -i &#x27;s/@have_mktemp_command@/yes/&#x27; gcc/gccbug.in</span><br><span class="line">mkdir -v ../gcc-build</span><br><span class="line">cd ../gcc-build</span><br><span class="line">../gcc-4.1.2/configure --prefix=/usr \</span><br><span class="line">--libexecdir=/usr/lib --enable-shared \</span><br><span class="line">--enable-threads=posix --enable-__cxa_atexit \</span><br><span class="line">--enable-clocale=gnu --enable-languages=c,c++</span><br><span class="line">make</span><br><span class="line">make -k check</span><br><span class="line">../gcc-4.1.2/contrib/test_summary</span><br><span class="line">make install</span><br><span class="line">ln -sv ../usr/bin/cpp /lib</span><br><span class="line">ln -sv gcc /usr/bin/cc</span><br><span class="line"></span><br><span class="line">echo &#x27;main()&#123;&#125;&#x27; &gt; dummy.c</span><br><span class="line">cc dummy.c -v -Wl,--verbose &amp;&gt; dummy.log</span><br><span class="line">readelf -l a.out | grep &#x27;: /lib&#x27;</span><br><span class="line"></span><br><span class="line">grep -o &#x27;/usr/lib.*/crt[1in].*succeeded&#x27; dummy.log</span><br><span class="line">grep -B3 &#x27;^ /usr/include&#x27; dummy.log</span><br><span class="line">grep &#x27;SEARCH.*/usr/lib&#x27; dummy.log |sed &#x27;s|; |\n|g&#x27;</span><br><span class="line">grep &quot;/lib/libc.so.6 &quot; dummy.log</span><br><span class="line">grep found dummy.log</span><br><span class="line">rm -v dummy.c a.out dummy.log</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gcc-4.1.2</span><br><span class="line">rm -rf gcc-build</span><br></pre></td></tr></table></figure>

<h2 id="11）DB-4-5-20"><a href="#11）DB-4-5-20" class="headerlink" title="11）DB-4.5.20"></a>11）<code>DB-4.5.20</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf db-4.5.20.tar.gz</span><br><span class="line">cd db-4.5.20</span><br><span class="line">patch -Np1 -i ../db-4.5.20-fixes-1.patch</span><br><span class="line">cd build_unix</span><br><span class="line">../dist/configure --prefix=/usr --enable-compat185 --enable-cxx</span><br><span class="line">make</span><br><span class="line">make docdir=/usr/share/doc/db-4.5.20 install</span><br><span class="line">chown -Rv root:root /usr/share/doc/db-4.5.20</span><br><span class="line">cd ..</span><br><span class="line">cd ..</span><br><span class="line">rm -rf db-4.5.20</span><br></pre></td></tr></table></figure>

<h2 id="12）Sed-4-1-5"><a href="#12）Sed-4-1-5" class="headerlink" title="12）Sed-4.1.5"></a>12）<code>Sed-4.1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf sed-4.1.5.tar.gz</span><br><span class="line">cd sed-4.1.5</span><br><span class="line">./configure --prefix=/usr --bindir=/bin --enable-html</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf sed-4.1.5</span><br></pre></td></tr></table></figure>

<h2 id="13）E2fsprogs-1-40-2"><a href="#13）E2fsprogs-1-40-2" class="headerlink" title="13）E2fsprogs-1.40.2"></a>13）<code>E2fsprogs-1.40.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">tar xvf e2fsprogs-1.40.2.tar.gz</span><br><span class="line">cd e2fsprogs-1.40.2</span><br><span class="line">sed -i -e &#x27;s@/bin/rm@/tools&amp;@&#x27; lib/blkid/test_probe.in</span><br><span class="line">mkdir -v build</span><br><span class="line">cd build</span><br><span class="line">../configure --prefix=/usr --with-root-prefix=&quot;&quot; \</span><br><span class="line">--enable-elf-shlibs</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make install-libs</span><br><span class="line">cd ..</span><br><span class="line">cd ..</span><br><span class="line">rm -rf e2fsprogs-1.40.2</span><br></pre></td></tr></table></figure>

<h2 id="14）Coreutils-6-9-1"><a href="#14）Coreutils-6-9-1" class="headerlink" title="14）Coreutils-6.9"></a>14）<code>Coreutils-6.9</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">tar xvf coreutils-6.9.tar.bz2</span><br><span class="line">cd coreutils-6.9</span><br><span class="line">patch -Np1 -i ../coreutils-6.9-uname-1.patch</span><br><span class="line">patch -Np1 -i ../coreutils-6.9-suppress_uptime_kill_su-1.patch</span><br><span class="line">patch -Np1 -i ../coreutils-6.9-i18n-1.patch</span><br><span class="line">chmod +x tests/sort/sort-mb-tests</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make NON_ROOT_USERNAME=nobody check-root</span><br><span class="line">echo &quot;dummy:x:1000:nobody&quot; &gt;&gt; /etc/group</span><br><span class="line">su-tools nobody -s /bin/bash -c &quot;make RUN_EXPENSIVE_TESTS=yes check&quot;</span><br><span class="line">sed -i &#x27;/dummy/d&#x27; /etc/group</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/&#123;cat,chgrp,chmod,chown,cp,date,dd,df,echo&#125; /bin</span><br><span class="line">mv -v /usr/bin/&#123;false,hostname,ln,ls,mkdir,mknod,mv,pwd,readlink,rm&#125; /bin</span><br><span class="line">mv -v /usr/bin/&#123;rmdir,stty,sync,true,uname&#125; /bin</span><br><span class="line">mv -v /usr/bin/chroot /usr/sbin</span><br><span class="line"></span><br><span class="line">mv -v /usr/bin/&#123;head,sleep,nice&#125; /bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf coreutils-6.9</span><br></pre></td></tr></table></figure>

<h2 id="15）Iana-Etc-2-20"><a href="#15）Iana-Etc-2-20" class="headerlink" title="15）Iana-Etc-2.20"></a>15）<code>Iana-Etc-2.20</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar xvf iana-etc-2.20.tar.bz2</span><br><span class="line">cd iana-etc-2.20</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf iana-etc-2.20</span><br></pre></td></tr></table></figure>

<h2 id="16）M4-1-4-10"><a href="#16）M4-1-4-10" class="headerlink" title="16）M4-1.4.10"></a>16）<code>M4-1.4.10</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf m4-1.4.10.tar.bz2</span><br><span class="line">cd m4-1.4.10</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf m4-1.4.10</span><br></pre></td></tr></table></figure>

<h2 id="17）Bison-2-3"><a href="#17）Bison-2-3" class="headerlink" title="17）Bison-2.3"></a>17）<code>Bison-2.3</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf bison-2.3.tar.bz2</span><br><span class="line">cd bison-2.3</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">echo &#x27;#define YYENABLE_NLS 1&#x27; &gt;&gt; config.h</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf bison-2.3</span><br></pre></td></tr></table></figure>

<h2 id="18）Ncurses-5-6"><a href="#18）Ncurses-5-6" class="headerlink" title="18）Ncurses-5.6"></a>18）<code>Ncurses-5.6</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">tar xvf ncurses-5.6.tar.gz</span><br><span class="line">cd ncurses-5.6</span><br><span class="line">patch -Np1 -i ../ncurses-5.6-coverity_fixes-1.patch</span><br><span class="line">./configure --prefix=/usr --with-shared --without-debug --enable-widec</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">chmod -v 644 /usr/lib/libncurses++w.a</span><br><span class="line">mv -v /usr/lib/libncursesw.so.5* /lib</span><br><span class="line">ln -sfv ../../lib/libncursesw.so.5 /usr/lib/libncursesw.so</span><br><span class="line"></span><br><span class="line">for lib in curses ncurses form panel menu ; do \</span><br><span class="line">    rm -vf /usr/lib/lib$&#123;lib&#125;.so ; \</span><br><span class="line">    echo &quot;INPUT(-l$&#123;lib&#125;w)&quot; &gt;/usr/lib/lib$&#123;lib&#125;.so ; \</span><br><span class="line">    ln -sfv lib$&#123;lib&#125;w.a /usr/lib/lib$&#123;lib&#125;.a ; \</span><br><span class="line">done</span><br><span class="line">ln -sfv libncurses++w.a /usr/lib/libncurses++.a</span><br><span class="line"></span><br><span class="line">rm -vf /usr/lib/libcursesw.so</span><br><span class="line">echo &quot;INPUT(-lncursesw)&quot; &gt;/usr/lib/libcursesw.so</span><br><span class="line">ln -sfv libncurses.so /usr/lib/libcurses.so</span><br><span class="line">ln -sfv libncursesw.a /usr/lib/libcursesw.a</span><br><span class="line">ln -sfv libncurses.a /usr/lib/libcurses.a</span><br><span class="line"></span><br><span class="line">make distclean</span><br><span class="line">./configure --prefix=/usr --with-shared --without-normal \</span><br><span class="line">  --without-debug --without-cxx-binding</span><br><span class="line">make sources libs</span><br><span class="line">cp -av lib/lib*.so.5* /usr/lib</span><br><span class="line"></span><br><span class="line">cd ..</span><br><span class="line">rm -rf ncurses-5.6</span><br></pre></td></tr></table></figure>

<h2 id="19）Procps-3-2-7"><a href="#19）Procps-3-2-7" class="headerlink" title="19）Procps-3.2.7"></a>19）<code>Procps-3.2.7</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar xvf procps-3.2.7.tar.gz</span><br><span class="line">cd procps-3.2.7</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf procps-3.2.7</span><br></pre></td></tr></table></figure>

<h2 id="20）Libtool-1-5-24"><a href="#20）Libtool-1-5-24" class="headerlink" title="20）Libtool-1.5.24"></a>20）<code>Libtool-1.5.24</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf libtool-1.5.24.tar.gz</span><br><span class="line">cd libtool-1.5.24</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf libtool-1.5.24</span><br></pre></td></tr></table></figure>

<h2 id="21）Perl-5-8-8"><a href="#21）Perl-5-8-8" class="headerlink" title="21）Perl-5.8.8"></a>21）<code>Perl-5.8.8</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf perl-5.8.8.tar.bz2</span><br><span class="line">cd perl-5.8.8</span><br><span class="line">echo &quot;127.0.0.1 localhost $(hostname)&quot; &gt; /etc/hosts</span><br><span class="line">./configure.gnu --prefix=/usr \</span><br><span class="line">-Dman1dir=/usr/share/man/man1 \</span><br><span class="line">-Dman3dir=/usr/share/man/man3 \</span><br><span class="line">-Dpager=&quot;/usr/bin/less -isR&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf perl-5.8.8</span><br></pre></td></tr></table></figure>

<h2 id="22）Readline-5-2"><a href="#22）Readline-5-2" class="headerlink" title="22）Readline-5.2"></a>22）<code>Readline-5.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tar xvf readline-5.2.tar.gz</span><br><span class="line">cd readline-5.2</span><br><span class="line">sed -i &#x27;/MV.*old/d&#x27; Makefile.in</span><br><span class="line">sed -i &#x27;/&#123;OLDSUFF&#125;/c:&#x27; support/shlib-install</span><br><span class="line">patch -Np1 -i ../readline-5.2-fixes-3.patch</span><br><span class="line">./configure --prefix=/usr --libdir=/lib</span><br><span class="line">make SHLIB_LIBS=-lncurses</span><br><span class="line">make install</span><br><span class="line">mv -v /lib/lib&#123;readline,history&#125;.a /usr/lib</span><br><span class="line">rm -v /lib/lib&#123;readline,history&#125;.so</span><br><span class="line">ln -sfv ../../lib/libreadline.so.5 /usr/lib/libreadline.so</span><br><span class="line">ln -sfv ../../lib/libhistory.so.5 /usr/lib/libhistory.so</span><br><span class="line">cd ..</span><br><span class="line">rm -rf readline-5.2</span><br></pre></td></tr></table></figure>

<h2 id="23）Zlib-1-2-3"><a href="#23）Zlib-1-2-3" class="headerlink" title="23）Zlib-1.2.3"></a>23）<code>Zlib-1.2.3</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tar xvf zlib-1.2.3.tar.gz</span><br><span class="line">cd zlib-1.2.3</span><br><span class="line">./configure --prefix=/usr --shared --libdir=/lib</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">rm -v /lib/libz.so</span><br><span class="line">ln -sfv ../../lib/libz.so.1.2.3 /usr/lib/libz.so</span><br><span class="line">make clean</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">chmod -v 644 /usr/lib/libz.a</span><br><span class="line">cd ..</span><br><span class="line">rm -rf zlib-1.2.3</span><br></pre></td></tr></table></figure>

<h2 id="24）Autoconf-2-61"><a href="#24）Autoconf-2-61" class="headerlink" title="24）Autoconf-2.61"></a>24）<code>Autoconf-2.61</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf autoconf-2.61.tar.bz2</span><br><span class="line">cd autoconf-2.61</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf autoconf-2.61</span><br></pre></td></tr></table></figure>

<h2 id="25）Automake-1-10"><a href="#25）Automake-1-10" class="headerlink" title="25）Automake-1.10"></a>25）<code>Automake-1.10</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf automake-1.10.tar.bz2</span><br><span class="line">cd automake-1.10</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf automake-1.10</span><br></pre></td></tr></table></figure>

<h2 id="26）Bash-3-2"><a href="#26）Bash-3-2" class="headerlink" title="26）Bash-3.2"></a>26）<code>Bash-3.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tar xvf bash-3.2.tar.gz</span><br><span class="line">cd bash-3.2</span><br><span class="line">tar -xvf ../bash-doc-3.2.tar.gz</span><br><span class="line">sed -i &quot;s|htmldir = @htmldir@|htmldir = /usr/share/doc/bash-3.2|&quot; \</span><br><span class="line">    Makefile.in</span><br><span class="line">patch -Np1 -i ../bash-3.2-fixes-5.patch</span><br><span class="line">./configure --prefix=/usr --bindir=/bin \</span><br><span class="line">    --without-bash-malloc --with-installed-readline</span><br><span class="line">make</span><br><span class="line">sed -i &#x27;s/LANG/LC_ALL/&#x27; tests/intl.tests</span><br><span class="line">sed -i &#x27;s@tests@&amp; &lt;/dev/tty@&#x27; tests/run-test</span><br><span class="line">chown -Rv nobody ./</span><br><span class="line">su-tools nobody -s /bin/bash -c &quot;make tests&quot;</span><br><span class="line">make install</span><br><span class="line">exec /bin/bash --login +h</span><br></pre></td></tr></table></figure>

<h2 id="27）Bzip2-1-0-4"><a href="#27）Bzip2-1-0-4" class="headerlink" title="27）Bzip2-1.0.4"></a>27）<code>Bzip2-1.0.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tar xvf bzip2-1.0.4.tar.gz</span><br><span class="line">cd bzip2-1.0.4</span><br><span class="line">patch -Np1 -i ../bzip2-1.0.4-install_docs-1.patch</span><br><span class="line">make -f Makefile-libbz2_so</span><br><span class="line">make clean</span><br><span class="line">make</span><br><span class="line">make PREFIX=/usr install</span><br><span class="line">cp -v bzip2-shared /bin/bzip2</span><br><span class="line">cp -av libbz2.so* /lib</span><br><span class="line">ln -sv http://.cnblogs.com/lib/libbz2.so.1.0 /usr/lib/libbz2.so</span><br><span class="line">rm -v /usr/bin/&#123;bunzip2,bzcat,bzip2&#125;</span><br><span class="line">ln -sv bzip2 /bin/bunzip2</span><br><span class="line">ln -sv bzip2 /bin/bzcat</span><br><span class="line">cd ..</span><br><span class="line">rm -rf bzip2-1.0.4</span><br></pre></td></tr></table></figure>

<h2 id="28）Diffutils-2-8-1"><a href="#28）Diffutils-2-8-1" class="headerlink" title="28）Diffutils-2.8.1"></a>28）<code>Diffutils-2.8.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf diffutils-2.8.1.tar.gz</span><br><span class="line">cd diffutils-2.8.1</span><br><span class="line">patch -Np1 -i ../diffutils-2.8.1-i18n-1.patch</span><br><span class="line">touch man/diff.1</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf diffutils-2.8.1</span><br></pre></td></tr></table></figure>

<h2 id="29）File-4-21"><a href="#29）File-4-21" class="headerlink" title="29）File-4.21"></a>29）<code>File-4.21</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf file-4.21.tar.gz</span><br><span class="line">cd file-4.21</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf file-4.21</span><br></pre></td></tr></table></figure>

<h2 id="30）Findutils-4-2-31"><a href="#30）Findutils-4-2-31" class="headerlink" title="30）Findutils-4.2.31"></a>30）<code>Findutils-4.2.31</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf findutils-4.2.31.tar.gz</span><br><span class="line">cd findutils-4.2.31</span><br><span class="line">./configure --prefix=/usr --libexecdir=/usr/lib/findutils \</span><br><span class="line">--localstatedir=/var/lib/locate</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/find /bin</span><br><span class="line">sed -i -e &#x27;s/find:=$&#123;BINDIR&#125;/find:=\/bin/&#x27; /usr/bin/updatedb</span><br><span class="line">cd ..</span><br><span class="line">rm -rf findutils-4.2.31</span><br></pre></td></tr></table></figure>

<h2 id="31）Flex-2-5-33"><a href="#31）Flex-2-5-33" class="headerlink" title="31）Flex-2.5.33"></a>31）<code>Flex-2.5.33</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">tar xvf flex-2.5.33.tar.bz2</span><br><span class="line">cd flex-2.5.33</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ln -sv libfl.a /usr/lib/libl.a</span><br><span class="line">cat &gt; /usr/bin/lex &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#!/bin/sh</span><br><span class="line"># Begin /usr/bin/lex</span><br><span class="line"></span><br><span class="line">exec /usr/bin/flex -l &quot;$@&quot;</span><br><span class="line"></span><br><span class="line"># End /usr/bin/lex</span><br><span class="line">EOF</span><br><span class="line">chmod -v 755 /usr/bin/lex</span><br><span class="line">cd ..</span><br><span class="line">rm -rf flex-2.5.33</span><br></pre></td></tr></table></figure>

<h2 id="32）GRUB-0-97"><a href="#32）GRUB-0-97" class="headerlink" title="32）GRUB-0.97"></a>32）<code>GRUB-0.97</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf grub-0.97.tar.gz</span><br><span class="line">cd grub-0.97</span><br><span class="line">patch -Np1 -i ../grub-0.97-disk_geometry-1.patch</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mkdir -v /boot/grub</span><br><span class="line">cp -v /usr/lib/grub/i386-pc/stage&#123;1,2&#125; /boot/grub</span><br><span class="line">cd ..</span><br><span class="line">rm -rf grub-0.97</span><br></pre></td></tr></table></figure>

<h2 id="33）Gawk-3-1-5"><a href="#33）Gawk-3-1-5" class="headerlink" title="33）Gawk-3.1.5"></a>33）<code>Gawk-3.1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tar xvf gawk-3.1.5.tar.bz2</span><br><span class="line">cd gawk-3.1.5</span><br><span class="line">patch -Np1 -i ../gawk-3.1.5-segfault_fix-1.patch</span><br><span class="line">./configure --prefix=/usr --libexecdir=/usr/lib</span><br><span class="line">cat &gt;&gt; config.h &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#define HAVE_LANGINFO_CODESET 1</span><br><span class="line">#define HAVE_LC_MESSAGES 1</span><br><span class="line">EOF</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gawk-3.1.5</span><br></pre></td></tr></table></figure>

<h2 id="34）Gettext-0-16-1"><a href="#34）Gettext-0-16-1" class="headerlink" title="34）Gettext-0.16.1"></a>34）<code>Gettext-0.16.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf gettext-0.16.1.tar.gz</span><br><span class="line">cd gettext-0.16.1</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gettext-0.16.1</span><br></pre></td></tr></table></figure>

<h2 id="35）Grep-2-5-1a"><a href="#35）Grep-2-5-1a" class="headerlink" title="35）Grep-2.5.1a"></a>35）<code>Grep-2.5.1a</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf grep-2.5.1a.tar.bz2</span><br><span class="line">cd grep-2.5.1a</span><br><span class="line">patch -Np1 -i ../grep-2.5.1a-redhat_fixes-2.patch</span><br><span class="line">chmod +x tests/fmbtest.sh</span><br><span class="line">./configure --prefix=/usr --bindir=/bin</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf grep-2.5.1a</span><br></pre></td></tr></table></figure>

<h2 id="36）Groff-1-18-1-4"><a href="#36）Groff-1-18-1-4" class="headerlink" title="36）Groff-1.18.1.4"></a>36）<code>Groff-1.18.1.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tar xvf groff-1.18.1.4.tar.gz</span><br><span class="line">cd groff-1.18.1.4</span><br><span class="line">patch -Np1 -i ../groff-1.18.1.4-debian_fixes-1.patch</span><br><span class="line">sed -i -e &#x27;s/2010/002D/&#x27; -e &#x27;s/2212/002D/&#x27; \</span><br><span class="line">-e &#x27;s/2018/0060/&#x27; -e &#x27;s/2019/0027/&#x27; font/devutf8/R.proto</span><br><span class="line">PAGE=A4 ./configure --prefix=/usr --enable-multibyte</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ln -sv eqn /usr/bin/geqn</span><br><span class="line">ln -sv tbl /usr/bin/gtbl</span><br><span class="line">cd ..</span><br><span class="line">rm -rf groff-1.18.1.4</span><br></pre></td></tr></table></figure>

<h2 id="37）Gzip-1-3-12"><a href="#37）Gzip-1-3-12" class="headerlink" title="37）Gzip-1.3.12"></a>37）<code>Gzip-1.3.12</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf gzip-1.3.12.tar.gz</span><br><span class="line">cd gzip-1.3.12</span><br><span class="line">./configure --prefix=/usr --bindir=/bin</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /bin/&#123;gzexe,uncompress,zcmp,zdiff,zegrep&#125; /usr/bin</span><br><span class="line">mv -v /bin/&#123;zfgrep,zforce,zgrep,zless,zmore,znew&#125; /usr/bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf gzip-1.3.12</span><br></pre></td></tr></table></figure>

<h2 id="38）Inetutils-1-5"><a href="#38）Inetutils-1-5" class="headerlink" title="38）Inetutils-1.5"></a>38）<code>Inetutils-1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tar xvf inetutils-1.5.tar.gz</span><br><span class="line">cd inetutils-1.5</span><br><span class="line">patch -Np1 -i ../inetutils-1.5-no_server_man_pages-2.patch</span><br><span class="line">./configure --prefix=/usr --libexecdir=/usr/sbin \</span><br><span class="line">--sysconfdir=/etc --localstatedir=/var \</span><br><span class="line">--disable-ifconfig --disable-logger --disable-syslogd \</span><br><span class="line">--disable-whois --disable-servers</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/ping /bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf inetutils-1.5</span><br></pre></td></tr></table></figure>

<h2 id="39）IPRoute2-2-6-20-070313"><a href="#39）IPRoute2-2-6-20-070313" class="headerlink" title="39）IPRoute2-2.6.20-070313"></a>39）<code>IPRoute2-2.6.20-070313</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tar xvf iproute2-2.6.20-070313.tar.gz</span><br><span class="line">cd iproute-2.6.20-070313</span><br><span class="line">sed -i -e &#x27;/tc-bfifo.8/d&#x27; -e &#x27;/tc-pfifo.8/s/pbfifo/bfifo/&#x27; Makefile</span><br><span class="line">make SBINDIR=/sbin</span><br><span class="line">make SBINDIR=/sbin install</span><br><span class="line">mv -v /sbin/arpd /usr/sbin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf iproute-2.6.20-070313</span><br></pre></td></tr></table></figure>

<h2 id="40）Kbd-1-12"><a href="#40）Kbd-1-12" class="headerlink" title="40）Kbd-1.12"></a>40）<code>Kbd-1.12</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf kbd-1.12.tar.bz2</span><br><span class="line">cd kbd-1.12</span><br><span class="line">patch -Np1 -i ../kbd-1.12-backspace-1.patch</span><br><span class="line">patch -Np1 -i ../kbd-1.12-gcc4_fixes-1.patch</span><br><span class="line">./configure --datadir=/lib/kbd</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/&#123;kbd_mode,openvt,setfont&#125; /bin</span><br><span class="line">cd ..</span><br><span class="line">rm -rf kbd-1.12</span><br></pre></td></tr></table></figure>

<h2 id="41）Less-406"><a href="#41）Less-406" class="headerlink" title="41）Less-406"></a>41）<code>Less-406</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf less-406.tar.gz</span><br><span class="line">cd less-406</span><br><span class="line">./configure --prefix=/usr --sysconfdir=/etc</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf less-406</span><br></pre></td></tr></table></figure>

<h2 id="42）Make-3-81"><a href="#42）Make-3-81" class="headerlink" title="42）Make-3.81"></a>42）<code>Make-3.81</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf make-3.81.tar.bz2</span><br><span class="line">cd make-3.81</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf make-3.81</span><br></pre></td></tr></table></figure>

<h2 id="43）Man-DB-2-4-4"><a href="#43）Man-DB-2-4-4" class="headerlink" title="43）Man-DB-2.4.4"></a>43）<code>Man-DB-2.4.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">tar xvf man-db-2.4.4.tar.gz</span><br><span class="line">cd man-db-2.4.4</span><br><span class="line">mv man/de&#123;_DE.88591,&#125;</span><br><span class="line">mv man/es&#123;_ES.88591,&#125;</span><br><span class="line">mv man/it&#123;_IT.88591,&#125;</span><br><span class="line">mv man/ja&#123;_JP.eucJP,&#125;</span><br><span class="line">sed -i &#x27;s,\*_\*,??,&#x27; man/Makefile.in</span><br><span class="line">sed -i -e &#x27;\%\t/usr/man%d&#x27; -e &#x27;\%\t/usr/local/man%d&#x27; src/man_db.conf.in</span><br><span class="line">cat &gt;&gt; include/manconfig.h.in &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#define WEB_BROWSER &quot;exec /usr/bin/lynx&quot;</span><br><span class="line">#define COL &quot;/usr/bin/col&quot;</span><br><span class="line">#define VGRIND &quot;/usr/bin/vgrind&quot;</span><br><span class="line">#define GRAP &quot;/usr/bin/grap&quot;</span><br><span class="line">EOF</span><br><span class="line">patch -Np1 -i ../man-db-2.4.4-fixes-1.patch</span><br><span class="line">./configure --prefix=/usr --enable-mb-groff --disable-setuid</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cat &gt;&gt; convert-mans &lt;&lt; &quot;EOF&quot;</span><br><span class="line">#!/bin/sh -e</span><br><span class="line">FROM=&quot;$1&quot;</span><br><span class="line">TO=&quot;$2&quot;</span><br><span class="line">shift ; shift</span><br><span class="line">while [ $# -gt 0 ]</span><br><span class="line">do</span><br><span class="line">FILE=&quot;$1&quot;</span><br><span class="line">shift</span><br><span class="line">iconv -f &quot;$FROM&quot; -t &quot;$TO&quot; &quot;$FILE&quot; &gt;.tmp.iconv</span><br><span class="line">mv .tmp.iconv &quot;$FILE&quot;</span><br><span class="line">done</span><br><span class="line">EOF</span><br><span class="line">install -m755 convert-mans /usr/bin</span><br><span class="line">mkdir -p /usr/share/man/en</span><br><span class="line">cp -rv man /usr/share/man/en</span><br><span class="line">cd ..</span><br><span class="line">rm -rf man-db-2.4.4</span><br></pre></td></tr></table></figure>

<h2 id="44）Mktemp-1-5"><a href="#44）Mktemp-1-5" class="headerlink" title="44）Mktemp-1.5"></a>44）<code>Mktemp-1.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf mktemp-1.5.tar.gz</span><br><span class="line">cd mktemp-1.5</span><br><span class="line">patch -Np1 -i ../mktemp-1.5-add_tempfile-3.patch</span><br><span class="line">./configure --prefix=/usr --with-libc</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make install-tempfile</span><br><span class="line">cd ..</span><br><span class="line">rm -rf cd mktemp-1.5</span><br></pre></td></tr></table></figure>

<h2 id="45）Module-Init-Tools-3-2-2"><a href="#45）Module-Init-Tools-3-2-2" class="headerlink" title="45）Module-Init-Tools-3.2.2"></a>45）<code>Module-Init-Tools-3.2.2</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xvf module-init-tools-3.2.2.tar.bz2</span><br><span class="line">cd module-init-tools-3.2.2</span><br><span class="line">patch -Np1 -i ../module-init-tools-3.2.2-modprobe-1.patch</span><br><span class="line">./configure</span><br><span class="line">make check</span><br><span class="line">make distclean</span><br><span class="line">./configure --prefix=/ --enable-zlib</span><br><span class="line">make</span><br><span class="line">make INSTALL=install install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf module-init-tools-3.2.2</span><br></pre></td></tr></table></figure>

<h2 id="46）Patch-2-5-4"><a href="#46）Patch-2-5-4" class="headerlink" title="46）Patch-2.5.4"></a>46）<code>Patch-2.5.4</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xvf patch-2.5.4.tar.gz</span><br><span class="line">cd patch-2.5.4</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">cd ..</span><br><span class="line">rm -rf patch-2.5.4</span><br></pre></td></tr></table></figure>

<h2 id="47）Psmisc-22-5"><a href="#47）Psmisc-22-5" class="headerlink" title="47）Psmisc-22.5"></a>47）<code>Psmisc-22.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf psmisc-22.5.tar.gz</span><br><span class="line">cd psmisc-22.5</span><br><span class="line">./configure --prefix=/usr --exec-prefix=&quot;&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /bin/pstree* /usr/bin</span><br><span class="line">ln -sv killall /bin/pidof</span><br><span class="line">cd ..</span><br><span class="line">rm -rf psmisc-22.5</span><br></pre></td></tr></table></figure>

<h2 id="48）Shadow-4-0-18-1"><a href="#48）Shadow-4-0-18-1" class="headerlink" title="48）Shadow-4.0.18.1"></a>48）<code>Shadow-4.0.18.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">tar xvf shadow-4.0.18.1.tar.bz2</span><br><span class="line">cd shadow-4.0.18.1</span><br><span class="line">patch -Np1 -i ../shadow-4.0.18.1-useradd_fix-2.patch</span><br><span class="line">./configure --libdir=/lib --sysconfdir=/etc --enable-shared \</span><br><span class="line">--without-selinux</span><br><span class="line">sed -i &#x27;s/groups$(EXEEXT) //&#x27; src/Makefile</span><br><span class="line">find man -name Makefile -exec sed -i &#x27;s/groups\.1 / /&#x27; &#123;&#125; \;</span><br><span class="line">sed -i -e &#x27;s/ ko//&#x27; -e &#x27;s/ zh_CN zh_TW//&#x27; man/Makefile</span><br><span class="line"></span><br><span class="line">for i in de es fi fr id it pt_BR; do</span><br><span class="line">    convert-mans UTF-8 ISO-8859-1 man/$&#123;i&#125;/*.?</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for i in cs hu pl; do</span><br><span class="line">    convert-mans UTF-8 ISO-8859-2 man/$&#123;i&#125;/*.?</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">convert-mans UTF-8 EUC-JP man/ja/*.?</span><br><span class="line">convert-mans UTF-8 KOI8-R man/ru/*.?</span><br><span class="line">convert-mans UTF-8 ISO-8859-9 man/tr/*.?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sed -i -e &#x27;s@#MD5_CRYPT_ENAB.no@MD5_CRYPT_ENAB yes@&#x27; \</span><br><span class="line">    -e &#x27;s@/var/spool/mail@/var/mail@&#x27; etc/login.defs</span><br><span class="line">sed -i &#x27;s@DICTPATH.*@DICTPATH\t/lib/cracklib/pw_dict@&#x27; \</span><br><span class="line">    etc/login.defs</span><br><span class="line"></span><br><span class="line">make </span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/passwd /bin</span><br><span class="line"></span><br><span class="line">mv -v /lib/libshadow.*a /usr/lib</span><br><span class="line">rm -v /lib/libshadow.so</span><br><span class="line">ln -sfv ../../lib/libshadow.so.0 /usr/lib/libshadow.so</span><br><span class="line"></span><br><span class="line">pwconv</span><br><span class="line">grpconv</span><br><span class="line"></span><br><span class="line">useradd -D -b /home</span><br><span class="line">sed -i &#x27;s/yes/no/&#x27; /etc/default/useradd</span><br><span class="line"></span><br><span class="line">passwd root</span><br></pre></td></tr></table></figure>

<h2 id="49）Sysklogd-1-4-1"><a href="#49）Sysklogd-1-4-1" class="headerlink" title="49）Sysklogd-1.4.1"></a>49）<code>Sysklogd-1.4.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">tar xf sysklogd-1.4.1.tar.bz2</span><br><span class="line">cd sysklogd-1.4.1</span><br><span class="line">patch -Np1 -i ../sysklogd-1.4.1-fixes-2.patch</span><br><span class="line">patch -Np1 -i ../sysklogd-1.4.1-8bit-1.patch</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/syslog.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/syslog.conf</span><br><span class="line"></span><br><span class="line">auth,authpriv.* -/var/log/auth.log</span><br><span class="line">*.*;auth,authpriv.none -/var/log/sys.log</span><br><span class="line">daemon.* -/var/log/daemon.log</span><br><span class="line">kern.* -/var/log/kern.log</span><br><span class="line">mail.* -/var/log/mail.log</span><br><span class="line">user.* -/var/log/user.log</span><br><span class="line">*.emerg *</span><br><span class="line"></span><br><span class="line"># End /etc/syslog.conf</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="50）Sysvinit-2-86"><a href="#50）Sysvinit-2-86" class="headerlink" title="50）Sysvinit-2.86"></a>50）<code>Sysvinit-2.86</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">tar xf sysvinit-2.86.tar.bz2</span><br><span class="line">cd Sysvinit-2.86</span><br><span class="line">sed -i &#x27;s@Sending processes@&amp; configured via /etc/inittab@g&#x27; \</span><br><span class="line">    src/init.c</span><br><span class="line">make -C src</span><br><span class="line">make -C src install</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/inittab &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/inittab</span><br><span class="line"></span><br><span class="line">id:3:initdefault:</span><br><span class="line"></span><br><span class="line">si::sysinit:/etc/rc.d/init.d/rc sysinit</span><br><span class="line"></span><br><span class="line">l0:0:wait:/etc/rc.d/init.d/rc 0</span><br><span class="line">l1:S1:wait:/etc/rc.d/init.d/rc 1</span><br><span class="line">l2:2:wait:/etc/rc.d/init.d/rc 2</span><br><span class="line">l3:3:wait:/etc/rc.d/init.d/rc 3</span><br><span class="line">l4:4:wait:/etc/rc.d/init.d/rc 4</span><br><span class="line">l5:5:wait:/etc/rc.d/init.d/rc 5</span><br><span class="line">l6:6:wait:/etc/rc.d/init.d/rc 6</span><br><span class="line"></span><br><span class="line">ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -r now</span><br><span class="line"></span><br><span class="line">su:S016:once:/sbin/sulogin</span><br><span class="line"></span><br><span class="line">1:2345:respawn:/sbin/agetty tty1 9600</span><br><span class="line">2:2345:respawn:/sbin/agetty tty2 9600</span><br><span class="line">3:2345:respawn:/sbin/agetty tty3 9600</span><br><span class="line">4:2345:respawn:/sbin/agetty tty4 9600</span><br><span class="line">5:2345:respawn:/sbin/agetty tty5 9600</span><br><span class="line">6:2345:respawn:/sbin/agetty tty6 9600</span><br><span class="line"></span><br><span class="line"># End /etc/inittab</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="51）Tar-1-18"><a href="#51）Tar-1-18" class="headerlink" title="51）Tar-1.18"></a>51）<code>Tar-1.18</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar xf tar-1.18.tar.bz2</span><br><span class="line">cd Tar-1.18</span><br><span class="line">./configure --prefix=/usr --bindir=/bin --libexecdir=/usr/sbin</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<h2 id="52）Texinfo-4-9"><a href="#52）Texinfo-4-9" class="headerlink" title="52）Texinfo-4.9"></a>52）<code>Texinfo-4.9</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tar xf texinfo-4.9.tar.bz2</span><br><span class="line">cd texinfo-4.9</span><br><span class="line">patch -Np1 -i ../texinfo-4.9-multibyte-1.patch</span><br><span class="line">patch -Np1 -i ../texinfo-4.9-tempfile_fix-1.patch</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make TEXMF=/usr/share/texmf install-tex</span><br><span class="line">cd /usr/share/info</span><br><span class="line">rm dir</span><br><span class="line">for f in *</span><br><span class="line">do install-info $f dir 2&gt;/dev/null</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="53）Udev-113"><a href="#53）Udev-113" class="headerlink" title="53）Udev-113"></a>53）<code>Udev-113</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">tar xf udev-113.tar.bz2</span><br><span class="line">cd udex-113</span><br><span class="line">tar -xvf ../udev-config-6.3.tar.bz2</span><br><span class="line"></span><br><span class="line">install -dv /lib/&#123;firmware,udev/devices/&#123;pts,shm&#125;&#125;</span><br><span class="line">mknod -m0666 /lib/udev/devices/null c 1 3</span><br><span class="line">ln -sv /proc/self/fd /lib/udev/devices/fd</span><br><span class="line">ln -sv /proc/self/fd/0 /lib/udev/devices/stdin</span><br><span class="line">ln -sv /proc/self/fd/1 /lib/udev/devices/stdout</span><br><span class="line">ln -sv /proc/self/fd/2 /lib/udev/devices/stderr</span><br><span class="line">ln -sv /proc/kcore /lib/udev/devices/core</span><br><span class="line"></span><br><span class="line">make EXTRAS=&quot;`echo extras/*/`&quot;</span><br><span class="line">make DESTDIR=/ EXTRAS=&quot;`echo extras/*/`&quot; install</span><br><span class="line">cp -v etc/udev/rules.d/[0-9]* /etc/udev/rules.d/</span><br><span class="line"></span><br><span class="line">cd udev-config-6.3</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">make install-doc</span><br><span class="line">make install-extra-doc</span><br><span class="line">cd ..</span><br><span class="line">install -m644 -v docs/writing_udev_rules/index.html \</span><br><span class="line">    /usr/share/doc/udev-113/index.html</span><br></pre></td></tr></table></figure>

<h2 id="54）Util-linux-2-12r"><a href="#54）Util-linux-2-12r" class="headerlink" title="54）Util-linux-2.12r"></a>54）<code>Util-linux-2.12r</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar xf util-linux-2.12r.tar.bz2</span><br><span class="line">cd util-linux-2.12r</span><br><span class="line">sed -e &#x27;s@etc/adjtime@var/lib/hwclock/adjtime@g&#x27; \</span><br><span class="line">    -i $(grep -rl &#x27;/etc/adjtime&#x27; .)</span><br><span class="line">mkdir -pv /var/lib/hwclock</span><br><span class="line">patch -Np1 -i ../util-linux-2.12r-cramfs-1.patch</span><br><span class="line">patch -Np1 -i ../util-linux-2.12r-lseek-1.patch</span><br><span class="line">./configure</span><br><span class="line">make HAVE_KILL=yes HAVE_SLN=yes</span><br><span class="line">make HAVE_KILL=yes HAVE_SLN=yes install</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="55）Vim-7-1"><a href="#55）Vim-7-1" class="headerlink" title="55）Vim-7.1"></a>55）<code>Vim-7.1</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">tar xf vim-7.1.tar.bz2</span><br><span class="line">cd vim71</span><br><span class="line">patch -Np1 -i ../vim-7.1-fixes-1.patch</span><br><span class="line">patch -Np1 -i ../vim-7.1-mandir-1.patch</span><br><span class="line">echo &#x27;#define SYS_VIMRC_FILE &quot;/etc/vimrc&quot;&#x27; &gt;&gt; src/feature.h</span><br><span class="line">./configure --prefix=/usr --enable-multibyte</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ln -sv vim /usr/bin/vi</span><br><span class="line">for L in &quot;&quot; fr it pl ru; do</span><br><span class="line">    ln -sv vim.1 /usr/share/man/$L/man1/vi.1</span><br><span class="line">done</span><br><span class="line">ln -sv ../vim/vim71/doc /usr/share/doc/vim-7.1</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/vimrc &lt;&lt; &quot;EOF&quot;</span><br><span class="line">&quot; Begin /etc/vimrc</span><br><span class="line"></span><br><span class="line">set nocompatible</span><br><span class="line">set backspace=2</span><br><span class="line">syntax on</span><br><span class="line">if (&amp;term == &quot;iterm&quot;) || (&amp;term == &quot;putty&quot;)</span><br><span class="line">  set background=dark</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">&quot; End /etc/vimrc</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">vim -c &#x27;:options&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="56）再次清理系统"><a href="#56）再次清理系统" class="headerlink" title="56）再次清理系统"></a>56）再次清理系统</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">logout</span><br><span class="line">chroot $LFS /tools/bin/env -i \</span><br><span class="line">    HOME=/root TERM=$TERM PS1=&#x27;\u:\w\$ &#x27; \</span><br><span class="line">    PATH=/bin:/usr/bin:/sbin:/usr/sbin \</span><br><span class="line">    /tools/bin/bash --login</span><br><span class="line"></span><br><span class="line">/tools/bin/find /&#123;,usr/&#125;&#123;bin,lib,sbin&#125; -type f \</span><br><span class="line">  -exec /tools/bin/strip --strip-debug &#x27;&#123;&#125;&#x27; &#x27;;&#x27;</span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="57）最终的清理"><a href="#57）最终的清理" class="headerlink" title="57）最终的清理"></a>57）最终的清理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chroot &quot;$LFS&quot; /usr/bin/env -i \</span><br><span class="line">    HOME=/root TERM=&quot;$TERM&quot; PS1=&#x27;\u:\w\$ &#x27; \</span><br><span class="line">    PATH=/bin:/usr/bin:/sbin:/usr/sbin \</span><br><span class="line">    /bin/bash --login</span><br></pre></td></tr></table></figure>

<h1 id="四、构建-LFS-3"><a href="#四、构建-LFS-3" class="headerlink" title="四、构建 LFS-3"></a>四、构建 <code>LFS-3</code></h1><h2 id="1）LFS-Bootscripts-6-3"><a href="#1）LFS-Bootscripts-6-3" class="headerlink" title="1）LFS-Bootscripts-6.3"></a>1）<code>LFS-Bootscripts-6.3</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd sources</span><br><span class="line">tar xf lfs-bootscripts-6.3.tar.bz2</span><br><span class="line">cd lfs-bootscripts-6.3</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<h2 id="2）配置-setclock-脚本"><a href="#2）配置-setclock-脚本" class="headerlink" title="2）配置 setclock 脚本"></a>2）配置 <code>setclock</code> 脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/sysconfig/clock &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/sysconfig/clock</span><br><span class="line"></span><br><span class="line">UTC=1</span><br><span class="line"></span><br><span class="line"># End /etc/sysconfig/clock</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="3）配置-Linux-控制台"><a href="#3）配置-Linux-控制台" class="headerlink" title="3）配置 Linux 控制台"></a>3）配置 <code>Linux</code> 控制台</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/sysconfig/console &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/sysconfig/console</span><br><span class="line"></span><br><span class="line"># End /etc/sysconfig/console</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="4）创建-etc-inputrc-文件"><a href="#4）创建-etc-inputrc-文件" class="headerlink" title="4）创建 /etc/inputrc 文件"></a>4）创建 <code>/etc/inputrc</code> 文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/inputrc &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/inputrc</span><br><span class="line"># Modified by Chris Lynn &lt;roryo@roryo.dynup.net&gt;</span><br><span class="line"></span><br><span class="line"># Allow the command prompt to wrap to the next line</span><br><span class="line">set horizontal-scroll-mode Off</span><br><span class="line"></span><br><span class="line"># Enable 8bit input</span><br><span class="line">set meta-flag On</span><br><span class="line">set input-meta On</span><br><span class="line"></span><br><span class="line"># Turns off 8th bit stripping</span><br><span class="line">set convert-meta Off</span><br><span class="line"></span><br><span class="line"># Keep the 8th bit for display</span><br><span class="line">set output-meta On</span><br><span class="line"></span><br><span class="line"># none, visible or audible</span><br><span class="line">set bell-style none</span><br><span class="line"></span><br><span class="line"># All of the following map the escape sequence of the value</span><br><span class="line"># contained in the 1st argument to the readline specific functions</span><br><span class="line">&quot;\eOd&quot;: backward-word</span><br><span class="line">&quot;\eOc&quot;: forward-word</span><br><span class="line"></span><br><span class="line"># for linux console</span><br><span class="line">&quot;\e[1~&quot;: beginning-of-line</span><br><span class="line">&quot;\e[4~&quot;: end-of-line</span><br><span class="line">&quot;\e[5~&quot;: beginning-of-history</span><br><span class="line">&quot;\e[6~&quot;: end-of-history</span><br><span class="line">&quot;\e[3~&quot;: delete-char</span><br><span class="line">&quot;\e[2~&quot;: quoted-insert</span><br><span class="line"></span><br><span class="line"># for xterm</span><br><span class="line">&quot;\eOH&quot;: beginning-of-line</span><br><span class="line">&quot;\eOF&quot;: end-of-line</span><br><span class="line"></span><br><span class="line"># for Konsole</span><br><span class="line">&quot;\e[H&quot;: beginning-of-line</span><br><span class="line">&quot;\e[F&quot;: end-of-line</span><br><span class="line"></span><br><span class="line"># End /etc/inputrc</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="5）Bash-Shell-启动文件"><a href="#5）Bash-Shell-启动文件" class="headerlink" title="5）Bash Shell 启动文件"></a>5）Bash Shell 启动文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/profile &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/profile</span><br><span class="line"></span><br><span class="line">export INPUTRC=/etc/inputrc</span><br><span class="line"></span><br><span class="line">source /etc/bashrc</span><br><span class="line"></span><br><span class="line">LANG=&quot;zh_CN&quot; ; export LANG</span><br><span class="line">[ &quot;$TERM&quot; = &quot;linux&quot; ] &amp;&amp; LC_ALL=C</span><br><span class="line">export LC_ALL</span><br><span class="line"></span><br><span class="line"># End /etc/profile</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/bashrc &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/bashrc</span><br><span class="line"></span><br><span class="line">alias ls=&#x27;ls --color=auto&#x27;</span><br><span class="line">alias ll=&#x27;ls -l&#x27;</span><br><span class="line">#eval $(dircolors -b /etc/dircolors)</span><br><span class="line"></span><br><span class="line"># Setup a red prompt for root and a green one for users.</span><br><span class="line">NORMAL=&quot;\[\e[0m\]&quot;</span><br><span class="line">RED=&quot;\[\e[1;31m\]&quot;</span><br><span class="line">GREEN=&quot;\[\e[1;32m\]&quot;</span><br><span class="line">YELLOW=&quot;\[\e[1;33m\]&quot;</span><br><span class="line">BLUB=&quot;\[\e[1;34m\]&quot;</span><br><span class="line">if [[ $EUID == 0 ]] ; then</span><br><span class="line">PS1=&quot;$RED[\u@$YELLOW\h $BLUB\W$RED]\\$ $NORMAL&quot;</span><br><span class="line">else</span><br><span class="line">PS1=&quot;$GREEN[\u@$YELLOW\h $BLUB\W$GREEN]\\$ $NORMAL&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ &quot;`locale charmap 2&gt;/dev/null`&quot; = &quot;UTF-8&quot; ]</span><br><span class="line">then</span><br><span class="line">stty iutf8</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># End /etc/bashrc</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="6）配置-localnet-脚本"><a href="#6）配置-localnet-脚本" class="headerlink" title="6）配置 localnet 脚本"></a>6）配置 <code>localnet</code> 脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;HOSTNAME=mylinux&quot; &gt; /etc/sysconfig/network</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="7）配置-etc-hosts-文件"><a href="#7）配置-etc-hosts-文件" class="headerlink" title="7）配置 /etc/hosts 文件"></a>7）配置 <code>/etc/hosts</code> 文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/hosts &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/hosts (network card version)</span><br><span class="line"></span><br><span class="line">127.0.0.1 mylinux localhost</span><br><span class="line"></span><br><span class="line"># End /etc/hosts (network card version)</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="8）配置网络脚本"><a href="#8）配置网络脚本" class="headerlink" title="8）配置网络脚本"></a>8）配置网络脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/sysconfig/network-devices</span><br><span class="line">mkdir -v ifconfig.eth0</span><br><span class="line">cat &gt; ifconfig.eth0/ipv4 &lt;&lt; &quot;EOF&quot;</span><br><span class="line">ONBOOT=yes</span><br><span class="line">SERVICE=ipv4-static</span><br><span class="line">IP=10.1.1.2</span><br><span class="line">GATEWAY=10.1.1.1</span><br><span class="line">PREFIX=24</span><br><span class="line">BROADCAST=10.1.1.255</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="9）创建-etc-resolv-conf-文件"><a href="#9）创建-etc-resolv-conf-文件" class="headerlink" title="9）创建 /etc/resolv.conf 文件"></a>9）创建 <code>/etc/resolv.conf</code> 文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/resolv.conf &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/resolv.conf</span><br><span class="line"></span><br><span class="line">nameserver 202.106.196.115</span><br><span class="line"></span><br><span class="line"># End /etc/resolv.conf</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="10）创建-etc-fstab-文件"><a href="#10）创建-etc-fstab-文件" class="headerlink" title="10）创建 /etc/fstab 文件"></a>10）创建 <code>/etc/fstab</code> 文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/fstab &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /etc/fstab</span><br><span class="line"></span><br><span class="line"># file system mount-point type options dump fsck</span><br><span class="line"># order</span><br><span class="line"></span><br><span class="line">/dev/hda2 / ext3 defaults 1 1</span><br><span class="line">/dev/hda1 swap swap pri=1 0 0</span><br><span class="line">proc /proc proc defaults 0 0</span><br><span class="line">sysfs /sys sysfs defaults 0 0</span><br><span class="line">devpts /dev/pts devpts gid=4,mode=620 0 0</span><br><span class="line">shm /dev/shm tmpfs defaults 0 0</span><br><span class="line"># End /etc/fstab</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h2 id="11）Linux-2-6-22-5"><a href="#11）Linux-2-6-22-5" class="headerlink" title="11）Linux-2.6.22.5"></a>11）<code>Linux-2.6.22.5</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cd /sources</span><br><span class="line">tar xvf linux-2.6.22.5.tar.bz2</span><br><span class="line">cd linux-2.6.22.5</span><br><span class="line">make mrproper</span><br><span class="line">make menuconfig</span><br><span class="line">make</span><br><span class="line">make modules_install</span><br><span class="line">cp -v arch/i386/boot/bzImage /boot/lfskernel-2.6.22.5</span><br><span class="line">cp -v System.map /boot/System.map-2.6.22.5</span><br><span class="line">cp -v .config /boot/config-2.6.22.5</span><br><span class="line">install -d /usr/share/doc/linux-2.6.22.5</span><br><span class="line">cp -r Documentation/* /usr/share/doc/linux-2.6.22.5</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="12）使-LFS-系统能够启动"><a href="#12）使-LFS-系统能够启动" class="headerlink" title="12）使 LFS 系统能够启动"></a>12）使 LFS 系统能够启动</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">grub</span><br><span class="line"></span><br><span class="line">root (hd0,1) # hda2</span><br><span class="line">setup (hd0)  # hda1</span><br><span class="line">quit</span><br><span class="line"></span><br><span class="line">cat &gt; /boot/grub/menu.lst &lt;&lt; &quot;EOF&quot;</span><br><span class="line"># Begin /boot/grub/menu.lst</span><br><span class="line"># By default boot the first menu entry.</span><br><span class="line">default 0</span><br><span class="line"></span><br><span class="line"># Allow 30 seconds before booting the default.</span><br><span class="line">timeout 30</span><br><span class="line"></span><br><span class="line"># Use prettier colors.</span><br><span class="line">color green/black light-green/black</span><br><span class="line"></span><br><span class="line"># The first entry is for LFS.</span><br><span class="line">title LFS 6.3</span><br><span class="line">root (hd0,1)</span><br><span class="line">kernel /boot/lfskernel-2.6.22.5 root=/dev/hda2</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">mkdir -v /etc/grub</span><br><span class="line">ln -sv /boot/grub/menu.lst /etc/grub</span><br><span class="line"></span><br><span class="line">echo 6.3 &gt; /etc/lfs-release</span><br><span class="line"></span><br><span class="line">logout</span><br></pre></td></tr></table></figure>

<h2 id="13）重启系统"><a href="#13）重启系统" class="headerlink" title="13）重启系统"></a>13）重启系统</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">umount -v $LFS/dev/pts</span><br><span class="line">umount -v $LFS/dev/shm</span><br><span class="line">umount -v $LFS/dev</span><br><span class="line">umount -v $LFS/proc</span><br><span class="line">umount -v $LFS/sys</span><br><span class="line"></span><br><span class="line">umount -v $LFS</span><br><span class="line"></span><br><span class="line">umount -v $LFS/usr</span><br><span class="line">umount -v $LFS/home</span><br><span class="line">umount -v $LFS</span><br><span class="line"></span><br><span class="line">shutdown -r now</span><br></pre></td></tr></table></figure>

<h2>测试</h2>

<p><img src="http://butatree.site:8888/images/2021/04/24/LFS6.3.png" alt="LFS6.3"></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2021-04-24</span><i class="fa fa-tag"></i><a class="tag" href="/tags/Linux/" title="Linux">Linux </a><a class="tag" href="/tags/LFS/" title="LFS">LFS </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://patmosss.github.io/2021/04/24/LFS6-3构建/,Patmos,LFS6.3构建,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="/2021/03/30/Linux-Tomcat%E9%83%A8%E7%BD%B2/" title="Linux-Tomcat部署">Próximo post</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>